# ================================
# 潜空间 (Latent Space) - 生产环境配置模板
# ================================

# ================================
# Database Configuration (Required)
# ================================
# 生产数据库连接 - 推荐使用专业托管服务
# 示例: PostgreSQL on Neon, Supabase, AWS RDS, 或 Google Cloud SQL
DATABASE_URL=postgresql://username:password@production-host:5432/latent_space_prod

# 数据库连接池配置
DB_POOL_MIN=2
DB_POOL_MAX=20
DB_POOL_IDLE_TIMEOUT=30000
DB_POOL_ACQUIRE_TIMEOUT=60000

# ================================
# Security Configuration (Critical)
# ================================
# 会话密钥 - 使用加密安全的随机字符串 (128+ 字符)
# 生成命令: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
SESSION_SECRET=REPLACE_WITH_SECURE_RANDOM_STRING_FOR_PRODUCTION

# CORS配置 - 限制允许的域名
CORS_ORIGIN=https://yourdomain.com,https://app.yourdomain.com

# Cookie安全设置
COOKIE_SECURE=true
COOKIE_SAMESITE=strict
COOKIE_DOMAIN=.yourdomain.com

# CSP (Content Security Policy)
CSP_ENABLED=true

# ================================
# Server Configuration (Required)
# ================================
# 生产服务器端口
PORT=5001

# 运行环境
NODE_ENV=production

# 日志级别 (error | warn | info | debug)
LOG_LEVEL=info

# 服务器超时设置
SERVER_TIMEOUT=30000
KEEP_ALIVE_TIMEOUT=5000

# ================================
# AI Services Configuration (Required)
# ================================
# OpenAI API - 主要AI服务提供商
OPENAI_API_KEY=sk-your-production-openai-api-key
OPENAI_ORG_ID=org-your-organization-id

# AI服务成本控制 (USD)
AI_DAILY_BUDGET_LIMIT=100.00
AI_MONTHLY_BUDGET_LIMIT=2000.00

# AI缓存配置 (生产环境推荐启用)
AI_CACHE_ENABLED=true
AI_CACHE_TTL_EMBEDDING=86400  # 24小时
AI_CACHE_TTL_COMPLETION=3600  # 1小时

# AI路由策略
AI_ROUTING_STRATEGY=performance-optimized

# 备用AI服务商 (可选)
ANTHROPIC_API_KEY=your-production-anthropic-key
DEEPSEEK_API_KEY=your-production-deepseek-key

# ================================
# Cache & Performance (Recommended)
# ================================
# Redis - 强烈推荐用于生产环境缓存
REDIS_URL=redis://username:password@production-redis-host:6379
REDIS_DB=0
REDIS_KEY_PREFIX=latent_space:
REDIS_TTL_DEFAULT=3600

# Redis连接池
REDIS_POOL_MAX=20
REDIS_POOL_MIN=2

# CDN配置
CDN_URL=https://cdn.yourdomain.com
STATIC_FILES_CDN=true

# ================================
# Monitoring & Logging (Required)
# ================================
# Sentry错误监控
SENTRY_DSN=https://your-sentry-dsn@o123456.ingest.sentry.io/1234567
SENTRY_ENVIRONMENT=production
SENTRY_RELEASE=1.0.0

# 应用性能监控 (APM)
NEW_RELIC_LICENSE_KEY=your-newrelic-license-key
DATADOG_API_KEY=your-datadog-api-key

# 日志管理
LOG_TO_FILE=true
LOG_DIRECTORY=/var/log/latent-space
LOG_MAX_SIZE=100mb
LOG_MAX_FILES=30

# ================================
# SSL/TLS Configuration (Required)
# ================================
# SSL证书路径 (如果使用文件)
SSL_CERT_PATH=/etc/ssl/certs/latent-space.crt
SSL_KEY_PATH=/etc/ssl/private/latent-space.key
SSL_CA_PATH=/etc/ssl/certs/ca-bundle.crt

# Let's Encrypt配置 (如果使用)
LETSENCRYPT_EMAIL=admin@yourdomain.com
LETSENCRYPT_DOMAINS=yourdomain.com,app.yourdomain.com

# ================================
# Email Service (Required)
# ================================
# SendGrid邮件服务
SENDGRID_API_KEY=SG.your-sendgrid-api-key
SENDGRID_FROM_EMAIL=noreply@yourdomain.com
SENDGRID_FROM_NAME=潜空间团队

# 邮件模板配置
EMAIL_TEMPLATE_WELCOME=d-welcome-template-id
EMAIL_TEMPLATE_RESET=d-reset-password-template-id
EMAIL_TEMPLATE_NOTIFICATION=d-notification-template-id

# ================================
# File Storage (Required)
# ================================
# AWS S3配置
AWS_REGION=us-west-2
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_S3_BUCKET=latent-space-production
AWS_S3_REGION=us-west-2

# 阿里云OSS配置 (备选)
ALICLOUD_ACCESS_KEY_ID=your-alicloud-access-key
ALICLOUD_ACCESS_KEY_SECRET=your-alicloud-secret
ALICLOUD_OSS_BUCKET=latent-space-prod
ALICLOUD_OSS_REGION=oss-cn-beijing

# 文件上传限制
MAX_FILE_SIZE=50mb
ALLOWED_FILE_TYPES=jpg,jpeg,png,pdf,doc,docx,ppt,pptx

# ================================
# Analytics & Tracking (Optional)
# ================================
# Google Analytics
GA_TRACKING_ID=G-XXXXXXXXXX
GA_MEASUREMENT_ID=G-XXXXXXXXXX

# 百度统计
BAIDU_ANALYTICS_ID=your-baidu-analytics-id

# 用户行为分析
MIXPANEL_TOKEN=your-mixpanel-token
AMPLITUDE_API_KEY=your-amplitude-api-key

# ================================
# Payment Integration (Optional)
# ================================
# Stripe支付 (如果有付费功能)
STRIPE_PUBLISHABLE_KEY=pk_live_your_stripe_public_key
STRIPE_SECRET_KEY=sk_live_your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# 微信支付
WECHAT_PAY_MCH_ID=your-merchant-id
WECHAT_PAY_KEY=your-wechat-pay-key

# ================================
# Social Login (Optional)
# ================================
# GitHub OAuth
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret

# Google OAuth
GOOGLE_CLIENT_ID=your-google-client-id.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret

# 微信登录
WECHAT_APP_ID=your-wechat-app-id
WECHAT_APP_SECRET=your-wechat-app-secret

# ================================
# Rate Limiting (Recommended)
# ================================
# API速率限制配置
RATE_LIMIT_WINDOW_MS=900000  # 15分钟
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=true

# IP白名单 (管理API)
ADMIN_IP_WHITELIST=203.0.113.0/24,198.51.100.0/24

# ================================
# Health Checks & Monitoring
# ================================
# 健康检查配置
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_TIMEOUT=5000

# Prometheus监控
METRICS_ENABLED=true
METRICS_PATH=/metrics
METRICS_AUTH_TOKEN=your-metrics-auth-token

# ================================
# Backup & Recovery (Critical)
# ================================
# 数据库备份配置
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # 每天凌晨2点
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=latent-space-backups

# ================================
# Compliance & Privacy (Required)
# ================================
# GDPR合规
GDPR_ENABLED=true
DATA_RETENTION_DAYS=2555  # 7年

# 用户数据导出
USER_DATA_EXPORT_ENABLED=true
USER_DATA_EXPORT_FORMAT=json

# 隐私策略
PRIVACY_POLICY_URL=https://yourdomain.com/privacy
TERMS_OF_SERVICE_URL=https://yourdomain.com/terms

# ================================
# Feature Flags (Optional)
# ================================
# 功能开关
FEATURE_AI_MATCHING=true
FEATURE_REAL_TIME_CHAT=true
FEATURE_VIDEO_CALLS=false
FEATURE_PREMIUM_FEATURES=true

# A/B测试
AB_TESTING_ENABLED=true
AB_TESTING_PROVIDER=optimizely

# ================================
# Regional Settings (Localization)
# ================================
# 时区设置
DEFAULT_TIMEZONE=Asia/Shanghai
SUPPORTED_TIMEZONES=Asia/Shanghai,America/New_York,Europe/London

# 多语言支持
DEFAULT_LANGUAGE=zh-CN
SUPPORTED_LANGUAGES=zh-CN,en-US

# 货币设置
DEFAULT_CURRENCY=CNY
SUPPORTED_CURRENCIES=CNY,USD,EUR